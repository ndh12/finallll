<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë™ë¬¼ ì „ë¬¸ ì±—ë´‡ (í´ë¼ì´ì–¸íŠ¸ ë²„ì „)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      display: flex;
      justify-content: center;
      padding: 30px;
    }
    #chatbox {
      background: white;
      width: 100%;
      max-width: 600px;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .message {
      margin: 10px 0;
      display: flex;
    }
    .user-msg {
      justify-content: flex-end;
    }
    .bot-msg {
      justify-content: flex-start;
    }
    .bubble {
      padding: 10px 15px;
      border-radius: 20px;
      max-width: 70%;
    }
    .user-msg .bubble {
      background-color: #cce5ff;
      align-self: flex-end;
    }
    .bot-msg .bubble {
      background-color: #d4edda;
      align-self: flex-start;
    }
    #input-box {
      display: flex;
      margin-top: 15px;
    }
    #user-input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #ccc;
    }
    button {
      padding: 10px 15px;
      margin-left: 10px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="chatbox">
    <h2>ğŸ¾ ë™ë¬¼ ì§€ì‹ ì „ë¬¸ ì±—ë´‡</h2>
    <div id="messages"></div>
    <div id="input-box">
      <input id="user-input" placeholder="ë™ë¬¼ì— ëŒ€í•´ ì§ˆë¬¸í•´ë³´ì„¸ìš”..." />
      <button onclick="sendMessage()">ë³´ë‚´ê¸°</button>
    </div>
  </div>

  <script>
    // íŒŒì´ì¬ animal_qa_db ì— ëŒ€ì‘í•˜ëŠ” JS ê°ì²´ (í‚¤ì›Œë“œëŠ” ë°°ì—´ë¡œ)
    const animal_qa_db = [
      {keywords: ["ì•ˆë…•", "ì•ˆë…•í•˜ì„¸ìš”", "í•˜ì´", "í—¬ë¡œìš°"], answer: "ë„¤ ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?"},
      {keywords: ["ê°•ì•„ì§€", "ë¨¹ìœ¼ë©´", "ì•ˆ", "ë ", "ê²ƒ", "ê¸ˆì§€", "ìŒì‹", "ì´ˆì½œë¦¿", "í¬ë„", "ì–‘íŒŒ", "ë§ˆëŠ˜"],
       answer: "ê°•ì•„ì§€ê°€ ë¨¹ìœ¼ë©´ ì•ˆ ë˜ëŠ” ìŒì‹: ì´ˆì½œë¦¿, í¬ë„, ì–‘íŒŒ, ë§ˆëŠ˜, ì¹´í˜ì¸, ì•Œì½”ì˜¬ ë“±ì´ ìˆì–´ìš”. ì ˆëŒ€ ì£¼ì§€ ë§ˆì„¸ìš”."},
      {keywords: ["ì´ˆì½œë¦¿", "ë¨¹ì—ˆì–´ìš”", "ì´ˆì½œë¦¿", "ë¨¹ì—ˆì–´"],
       answer: "ì´ˆì½œë¦¿ì€ ê°•ì•„ì§€ì—ê²Œ ë§¤ìš° ë…ì„±ì´ ìˆìœ¼ë‹ˆ ì¦‰ì‹œ ë™ë¬¼ë³‘ì›ì— ë°ë ¤ê°€ì•¼ í•©ë‹ˆë‹¤."},
      {keywords: ["ë˜¥", "ë§ì´", "ì‹¸ìš”", "ë°°ë³€", "ì„¤ì‚¬", "ë³€", "ìì£¼", "ëŒ€ë³€", "ë˜¥", "ë§ì´", "ì‹¸", "ë§ì´", "ìŒ”"],
       answer: "ê°•ì•„ì§€ê°€ ë°°ë³€ì„ ë§ì´ í•˜ê±°ë‚˜ ì„¤ì‚¬ë¥¼ í•œë‹¤ë©´ ì†Œí™” ë¬¸ì œ, ê¸°ìƒì¶© ê°ì—¼, ìŠ¤íŠ¸ë ˆìŠ¤ ë“±ì´ ì›ì¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒíƒœê°€ ì‹¬í•˜ë©´ ë™ë¬¼ë³‘ì› ë°©ë¬¸ì´ í•„ìš”í•´ìš”."},
      {keywords: ["ê¸ì–´ìš”", "ê°€ë ¤ì›Œ", "ë²¼ë£©", "í”¼ë¶€", "ë¬¸ì œ", "ê¸ì–´", "ê°€ë ¤ì›Œí•´"],
       answer: "ê°•ì•„ì§€ê°€ ìì£¼ ê¸ëŠ”ë‹¤ë©´ ì•Œë ˆë¥´ê¸°, ë²¼ë£©, í”¼ë¶€ ê°ì—¼ ë“±ì´ ì›ì¸ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ ìˆ˜ì˜ì‚¬ ìƒë‹´ì„ ì¶”ì²œí•©ë‹ˆë‹¤."},
      {keywords: ["ê³ ì–‘ì´", "ì•¼ì˜¹", "ìš¸ìŒ", "ì†Œë¦¬"],
       answer: "ê³ ì–‘ì´ëŠ” ì˜ì‚¬ì†Œí†µì„ ìœ„í•´ ì•¼ì˜¹í•˜ë©°, ë°°ê³ í”„ê±°ë‚˜ ê´€ì‹¬ ë°›ê³  ì‹¶ì„ ë•Œ ì£¼ë¡œ ìš¸ì–´ìš”."},
      {keywords: ["ê³ ì–‘ì´", "ì•ˆ", "ë¨¹ì–´ìš”", "ì‹ìš•", "ë¶€ì§„", "ë°¥", "ì•ˆ", "ë¨¹ì–´"],
       answer: "ê³ ì–‘ì´ê°€ ì‹ìš•ì´ ë–¨ì–´ì§€ë©´ ìŠ¤íŠ¸ë ˆìŠ¤ë‚˜ ê±´ê°• ë¬¸ì œì¼ ìˆ˜ ìˆì–´ìš”. ìˆ˜ì˜ì‚¬ ìƒë‹´ì„ ê¶Œì¥í•©ë‹ˆë‹¤."},
      {keywords: ["ë¬¼", "ë§ì´", "ë§ˆì…”ìš”", "ê°ˆì¦", "ë¬¼", "ë§ì´", "ë§ˆì…”"],
       answer: "ê°•ì•„ì§€ê°€ ë¬¼ì„ ë§ì´ ë§ˆì‹œë©´ ë‹¹ë‡¨, ì‹ ì¥ ì§ˆí™˜ ë“±ì´ ì˜ì‹¬ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜ê°€ í•„ìš”í•´ìš”."},
      {keywords: ["ëª©ìš•", "ì£¼ê¸°", "ì–¼ë§ˆë‚˜", "ìì£¼", "ëª©ìš•", "í•´"],
       answer: "ê°•ì•„ì§€ëŠ” ë³´í†µ 2~4ì£¼ì— í•œ ë²ˆ ëª©ìš•í•˜ëŠ” ê²Œ ì ë‹¹í•˜ì§€ë§Œ, í”¼ë¶€ ìƒíƒœì— ë”°ë¼ ì¡°ì ˆí•˜ì„¸ìš”."},
      {keywords: ["ì§–ì–´ìš”", "ì§–ìŒ", "ì§–ëŠ”", "ì´ìœ ", "ì§–ì–´", "ë§ì´"],
       answer: "ê°•ì•„ì§€ê°€ ë§ì´ ì§–ìœ¼ë©´ ìŠ¤íŠ¸ë ˆìŠ¤, ë¶ˆì•ˆ, ì™¸ë¡œì›€ ë“±ì´ ì›ì¸ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ í™˜ê²½ì„ ì ê²€í•´ ì£¼ì„¸ìš”."},
      {keywords: ["í™”ì¥ì‹¤", "ì•ˆ", "ê°€ìš”", "ë°°ë³€", "ë¬¸ì œ"],
       answer: "ê³ ì–‘ì´ê°€ í™”ì¥ì‹¤ì„ ìì£¼ ì•ˆ ê°€ë©´ ìš”ë¡œ ì§ˆí™˜ ë“±ì´ ì˜ì‹¬ë˜ë‹ˆ ìˆ˜ì˜ì‚¬ ìƒë‹´ì„ ê¶Œí•©ë‹ˆë‹¤."},
      {keywords: ["ê³µê²©ì ì´ì—ìš”", "ê°‘ìê¸°", "ê³µê²©", "í–‰ë™", "ê³µê²©ì ì´ì•¼", "ì‚¬ë‚˜ì›Œ"],
       answer: "ê°•ì•„ì§€ê°€ ê°‘ìê¸° ê³µê²©ì ì´ë©´ ìŠ¤íŠ¸ë ˆìŠ¤, í†µì¦, í™˜ê²½ ë³€í™” ë•Œë¬¸ì¼ ìˆ˜ ìˆì–´ ê´€ì°°ê³¼ ìˆ˜ì˜ì‚¬ ìƒë‹´ì´ í•„ìš”í•©ë‹ˆë‹¤."},
      {keywords: ["ì˜ˆë°©ì ‘ì¢…", "ì ‘ì¢…", "ì£¼ê¸°", "ë°±ì‹ "],
       answer: "ê°•ì•„ì§€ ì˜ˆë°©ì ‘ì¢…ì€ ìƒí›„ 6~8ì£¼ë¶€í„° ì‹œì‘í•´ ì •ê¸°ì ìœ¼ë¡œ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤. ìˆ˜ì˜ì‚¬ì™€ ìƒë‹´í•˜ì„¸ìš”."},
      {keywords: ["ì‚¬ë£Œ", "ì¶”ì²œ", "ë¨¹ì´", "ë°¥"],
       answer: "ì—°ë ¹ê³¼ ê±´ê°• ìƒíƒœì— ë§ëŠ” ê· í˜• ì¡íŒ ì‚¬ë£Œë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤."},
      {keywords: ["ì˜", "ì§€ëƒˆì–´", "ìš”ì¦˜", "ì–´ë•Œ", "ì–´ë–»ê²Œ", "ì§€ë‚´"],
       answer: "ë„¤, ì˜ ì§€ë‚´ê³  ìˆì–´ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?"},
      {keywords: ["ê¸°ë³¸"], answer: "ì£„ì†¡í•´ìš”, ê·¸ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ì´ ì•„ì§ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ì–´ìš”."}
    ];

    const animals = ["ê°•ì•„ì§€", "ê°œ", "ê³ ì–‘ì´", "ìº£", "í¼í”¼", "ì• ì™„ë™ë¬¼"];

    function normalizeText(text) {
      const replacements = {
        "ë¨¹ì–´": "ë¨¹ì–´ìš”",
        "í–ˆì–´": "í–ˆì–´ìš”",
        "ê°€": "ê°€ìš”",
        "í•´": "í•´ìš”",
        "ì§€ëƒˆì–´": "ì§€ëƒˆì–´ìš”",
        "ë´¤ì–´": "ë´¤ì–´ìš”",
        "ìˆì–´": "ìˆì–´ìš”",
        "ì‹¸": "ì‹¸ìš”",
        "ë§ˆì…”": "ë§ˆì…”ìš”",
        "ì§–ì–´": "ì§–ì–´ìš”",
        "ê°€ë ¤ì›Œí•´": "ê°€ë ¤ì›Œìš”"
      };
      for (const [k, v] of Object.entries(replacements)) {
        text = text.replaceAll(k, v);
      }
      return text;
    }

    function findAnswer(user_input) {
      user_input = user_input.toLowerCase();
      user_input = normalizeText(user_input);
      const words = user_input.split(/\s+/);

      let detected_animal = null;
      for (const animal of animals) {
        if (words.includes(animal)) {
          detected_animal = animal;
          break;
        }
      }

      let best_answer = animal_qa_db.find(x => x.keywords.includes("ê¸°ë³¸")).answer;
      let max_score = 0;

      for (const entry of animal_qa_db) {
        let keywordTokens = new Set();
        for (const kw of entry.keywords) {
          for (const w of kw.toLowerCase().split(/\s+/)) {
            keywordTokens.add(w);
          }
        }

        let overlap = 0;
        for (const w of words) {
          if (keywordTokens.has(w)) overlap++;
        }

        let animal_bonus = 0;
        if (detected_animal) {
          if (keywordTokens.has(detected_animal)) animal_bonus = 2;
          if (detected_animal === "ê°•ì•„ì§€" && keywordTokens.has("ê°œ")) animal_bonus = 2;
          if (detected_animal === "ê°œ" && keywordTokens.has("ê°•ì•„ì§€")) animal_bonus = 2;
          if (detected_animal === "ê³ ì–‘ì´" && keywordTokens.has("ìº£")) animal_bonus = 2;
          if (detected_animal === "ìº£" && keywordTokens.has("ê³ ì–‘ì´")) animal_bonus = 2;
        }

        const score = overlap + animal_bonus;

        if (score > max_score) {
          max_score = score;
          best_answer = entry.answer;
        }
      }

      return best_answer;
    }

    function addMessage(sender, text) {
      const msgDiv = document.createElement("div");
      msgDiv.className = "message " + (sender === "user" ? "user-msg" : "bot-msg");

      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.innerText = text;

      msgDiv.appendChild(bubble);
      document.getElementById("messages").appendChild(msgDiv);
      window.scrollTo(0, document.body.scrollHeight);
    }

    function sendMessage() {
      const input = document.getElementById("user-input");
      const message = input.value.trim();
      if (!message) return;

      addMessage("user", message);
      input.value = "";

      try {
        const reply = findAnswer(message);
        addMessage("bot", reply);
      } catch (err) {
        addMessage("bot", "âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
      }
    }
  </script>
</body>
</html>
